{% extends "base.html" %}

{% block content %}
  <h1>Transactions</h1>

  <form method="get" style="margin-bottom: 1rem;">
    <label>
      Subject:
      <select name="subject_id">
        <option value="">All</option>
        {% for s in subjects %}
          <option value="{{ s.id }}" {% if request.GET.subject_id == s.id|stringformat:"s" %}selected{% endif %}>
            {{ s.name }}
          </option>
        {% endfor %}
      </select>
    </label>

    <label style="margin-left: 1rem;">
      Project:
      <select name="project_id">
        <option value="">All</option>
        {% for p in projects %}
          <option value="{{ p.id }}" {% if request.GET.project_id == p.id|stringformat:"s" %}selected{% endif %}>
            {{ p.name }}
          </option>
        {% endfor %}
      </select>
    </label>

    <button type="submit">Filter</button>
  </form>

  <table border="1" cellpadding="4" cellspacing="0">
    <thead>
      <tr>
        <th>Date</th>
        <th>Title</th>
        <th>Type</th>
        <th>Amount</th>
        <th>Unit</th>
        <th>Subject</th>
        <th>Project</th>
      </tr>
    </thead>
    <tbody>
      {% for tx in transactions %}
        <tr>
          <td>{{ tx.occurred_at|date:"Y-m-d" }}</td>
          <td>{{ tx.title }}</td>
          <td>{{ tx.type }}</td>
          <td>{{ tx.amount }}</td>
          <td>{{ tx.unit.code }}</td>
          <td>{{ tx.subject.name }}</td>
          <td>{{ tx.project.name }}</td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="7">No transactions found.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}
